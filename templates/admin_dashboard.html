<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="/static/css/admin_dashboard-style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
  <div class="admin-container"> 
    <!-- Header -->
    <header class="header-container">
      <div class="header-logo-placeholder" onclick="window.location.href='/'" style="cursor:pointer;">CARS</div> <!-- New Header Logo -->
      <div class="header-spacer"></div> <!-- Pinalitan ang inline style ng class -->
      <div class="profile-section" id="profileSection">
        <div class="profile-username" id="profileUsername"></div>
        <div class="profile-avatar" id="profileAvatar">
          <img src="/static/resources/profile/default-avatar.png" alt="Profile Avatar" id="profileAvatarImg" />
          <input type="file" id="profileAvatarInput" accept="image/*" style="display:none;" />
        </div>
        <span class="profile-dropdown-arrow-icon" id="profileDropdownArrow">&#9662;</span> <!-- Pinalitan ang inline style ng class -->
        <div class="profile-dropdown-menu" id="profileDropdownMenu">
          <a href="#" id="profileMenuProfile">Profile</a>
          <a href="#" id="profileMenuSettings">Settings</a>
          <a href="#" id="profileMenuLogout">Logout</a>
        </div>
      </div>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar" id="adminSidebar">
      <div class="sidebar-top">
        <div class="sidebar-header">
          <div class="logo" id="sidebarLogo" onclick="window.location.href='/'" style="cursor:pointer;">CARS</div>
          <button id="sidebarToggleBtn" class="sidebar-toggle-btn" aria-label="Toggle Sidebar">
            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
              <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path>
            </svg>
          </button>
        </div>
        <div id="adminWelcomeMessage" class="admin-welcome-message"></div> <!-- New Welcome Message Div -->
        <nav class="menu">
          <a href="#" class="menu-item" data-text="Dashboard">
            <span class="menu-icon">D</span>
            <span class="menu-text">Dashboard</span>
          </a>
          <a href="#reservations" class="menu-item" data-text="Reservations">
            <span class="menu-icon">R</span>
            <span class="menu-text">Reservations</span>
          </a>
          <a href="#payments" class="menu-item" data-text="Payments">
            <span class="menu-icon">P</span>
            <span class="menu-text">Payments</span>
          </a>
          <a href="#manage_accounts" class="menu-item" data-text="Manage Accounts">
            <span class="menu-icon">M</span>
            <span class="menu-text">Manage Accounts</span>
          </a>
          <a href="#reports" class="menu-item" data-text="Reports">
            <span class="menu-icon">R</span>
            <span class="menu-text">Reports</span>
          </a>
          <a href="#" id="logoutBtn" class="menu-item logout" data-text="Logout">
            <span class="menu-icon">
              <svg class="logout-svg" width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="3" y="4" width="12" height="14" rx="3" fill="#ff6b6b"/>
                <rect x="15.5" y="9" width="4" height="4" rx="1.5" fill="#fff"/>
                <rect x="15.5" y="9" width="4" height="4" rx="1.5" stroke="#ff6b6b" stroke-width="1.5"/>
              </svg>
            </span>
            <span class="menu-text">Logout</span>
          </a>
        </nav>
      </div>
    </aside>


    <!-- Main Content Panel -->
    <main class="main-content"> 
      <h2 id="main-title" style="display:none !important;"></h2> <!-- Laging nakatago -->
      
      <!-- Dashboard Section (Default Visible Panel) -->
      <section id="dashboard-section" class="panel-section">
        <div class="dashboard-header-row">
          <h2 class="dashboard-title">Dashboard Overview</h2>
          <div class="dashboard-date">June 1, 2025</div>
        </div>
        <div class="dashboard-cards">
          <div class="dashboard-card">
            <div class="card-icon">üìä</div>
            <div class="card-title">Reservations Today</div>
            <div class="card-value" id="reservations-today">--</div>
          </div>
          <div class="dashboard-card">
            <div class="card-icon">üßë‚Äçüíº</div>
            <div class="card-title">Active Residents</div>
            <div class="card-value" id="active-residents">--</div>
          </div>
          <div class="dashboard-card">
            <div class="card-icon">üõ†Ô∏è</div>
            <div class="card-title">Pending Amenity Approvals</div>
            <div class="card-value" id="pending-amenities">--</div>
          </div>
          <div class="dashboard-card">
            <div class="card-icon">üí∏</div>
            <div class="card-title">Payments Today / Month</div>
            <div class="card-value" id="payments-today">-- / --</div>
          </div>
          <div class="dashboard-card">
            <div class="card-icon">üîê</div>
            <div class="card-title">Total Admins</div>
            <div class="card-value" id="total-admins">--</div>
          </div>
        </div>
        <div class="dashboard-piechart-container">
          <canvas id="dashboardPieChart" width="340" height="340" aria-label="Dashboard Pie Chart" role="img"></canvas>
          <div class="piechart-legend">
            <div><span class="legend-color" style="background:#4F8EF7"></span> Reservations Today</div>
            <div><span class="legend-color" style="background:#43D9A3"></span> Active Residents</div>
            <div><span class="legend-color" style="background:#F7B84F"></span> Pending Amenity Approvals</div>
            <div><span class="legend-color" style="background:#F76C5E"></span> Payments Today</div>
            <div><span class="legend-color" style="background:#A16AE8"></span> Total Admins</div>
          </div>
        </div>
        <div class="dashboard-graphs-row">
          <div class="dashboard-graph-card">
            <h3 class="graph-title">Reservations This Week</h3>
            <canvas id="reservationsBarGraph" width="520" height="260" aria-label="Reservations Bar Graph" role="img"></canvas>
          </div>
          <div class="dashboard-events-card">
            <h3 class="graph-title">Latest Event / Happenings</h3>
            <div id="latest-events-list" class="latest-events-list">
              <div class="event-placeholder">No recent events.</div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- Included section panels (now inside main-content) -->
      {% include 'admin_sidebar/manage_accounts.html' %}
      {% include 'admin_sidebar/reservation.html' %}
      {% include 'admin_sidebar/payments.html' %}
      {% include 'admin_sidebar/reports.html' %}
      
      <section id="settings-section" class="panel-section" style="display:none;">
        <h2>Account Settings</h2>
        <ul>
          <li>Update personal admin profile</li>
          <li>Change password</li>
          <li>Upload/change profile image</li>
        </ul>
      </section>
    </main>
  </div>

  <!-- Profile Edit Modal with Cropper -->
  <div id="profileEditModal" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close" id="closeProfileModal">&times;</span>
      <h2>Edit Profile</h2>
      <form id="profileEditForm" autocomplete="off">
        <div class="modal-avatar-row">
          <img id="modalProfileAvatarImg" src="/static/resources/profile/default-avatar.png" alt="Profile Avatar" class="modal-avatar-img" style="max-width:120px;max-height:120px;" />
          <input type="file" id="modalProfileAvatarInput" accept="image/*" style="display:none;" />
          <button type="button" class="modal-upload-btn" id="modalChangeAvatarBtn">Change</button>
        </div>
        <div id="cropperContainer" style="display:none;text-align:center;margin-bottom:12px;">
          <img id="cropperImage" style="max-width:220px;max-height:220px;display:block;margin:0 auto;" />
          <button type="button" id="cropImageBtn" style="margin-top:8px;">Crop & Use</button>
        </div>
        <input type="hidden" id="croppedAvatarData" name="cropped_avatar" />
        <div class="modal-field">
          <label for="modalProfileUsername">Name</label>
          <input type="text" id="modalProfileUsername" name="username" required />
        </div>
        <div id="profileModalMsg" class="modal-msg" style="display:none;"></div>
        <button type="submit" class="modal-save-btn">Save Changes</button>
      </form>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/cropperjs@1.5.13/dist/cropper.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/cropperjs@1.5.13/dist/cropper.min.css" rel="stylesheet" />
  
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="/static/js/profile.js"></script>
<script src="/static/js/admin_dashboard.js"></script>
</body>
</html>

